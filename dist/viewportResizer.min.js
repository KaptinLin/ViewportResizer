/*! ViewportResizer - v0.2.0 - 2012-10-16
* https://github.com/KaptinLin/ViewportResizer
* Copyright (c) 2012 KaptinLin; Licensed CC BY-NC 3.0 */
(function(e,t,n,r){"use strict";function i(e){return(typeof e=="string"||typeof e=="number")&&!isNaN(e-0)&&e!==""}function s(e){if(i(e))return e/2;if(typeof e=="string"&&e.charAt(e.length-1)=="%")return e.substr(0,e.length-1)/2+"%"}var o=n.ViewportResizer=function(t){function E(){o.$viewport=n("<div />").addClass(v).appendTo(o.settings.container.viewport),o.current={},h.build(),r.build(),u.build(),f.build(),l.build(),c.build(),h.bind(),r.bind(),u.bind(),f.bind(),l.bind(),c.bind(),o.$viewport.attr("data-current","auto"),a.init()}function S(e){return e=="auto"?{width:"100%",height:"100%"}:{width:o.settings.viewports[e].width,height:o.settings.viewports[e].height}}function x(){var e=jQuery('<div style="width: 100%; height:200px;">test</div>'),t=jQuery('<div style="width:200px; height:150px; position: absolute; top: 0; left: 0; visibility: hidden; overflow:hidden;"></div>').append(e),n=e[0],r=t[0];jQuery("body").append(r);var i=n.offsetWidth;t.css("overflow","scroll");var s=r.clientWidth;return t.remove(),i-s}n.extend(o.settings,t);var r,u,a,f,l,c,h,p=x(),d=o.settings.classNamePrefix+"-switcher",v=o.settings.classNamePrefix+"-viewport",m=o.settings.classNamePrefix+"-iframe",g=o.settings.classNamePrefix+"-resizable",y=o.settings.classNamePrefix+"-axis",b=o.settings.classNamePrefix+"-info",w=o.settings.classNamePrefix+"-target";o.query={},a={init:function(t){n.extend(o.query,a.getQuery()),a.go(o.query),e.onpopstate=function(t){e.onpopstateing=!0,t.state!==null&&a.go(t.state),e.onpopstateing=!1,t.preventDefault()}},go:function(e){if(typeof e.viewport!="undefined")if(e.viewport=="optional"){var t={width:e.width?parseInt(e.width):o.settings.min.width,height:e.height?parseInt(e.height):o.settings.min.height};r.to("optional",t),r.optional.activeMatch(t)}else typeof o.settings.viewports[e.viewport]!="undefined"&&r.to(e.viewport);typeof e.target!="undefined"?(h.set(e.target),u.load(e.target)):typeof o.settings.target!="undefined"&&(h.set(o.settings.target),u.load(o.settings.target))},pushState:function(t){if(e.onpopstateing===!0)return;if(e.history&&e.history.pushState&&e.history.replaceState){var r=[];n.each(t,function(e,t){t!=null&&r.push(e+"="+t)});var i="?"+r.join("&");e.history.pushState(t,"",i)}},getQuery:function(t){typeof t=="undefined"&&(t=e.location.href);var r={},i=t.replace(/#[^\s]+/,"").split("?")[1];return typeof i!="undefined"&&(i=i.split("&"),n.each(i,function(e,t){var n=t.split("=");r[n[0]]=n[1]})),r},setQuery:function(e){e=n.extend(o.query,e),a.pushState(e)}},h={build:function(){o.$target=n("<div/>").addClass(w),h.input=n('<input type="text"/>').addClass(w+"-input").val(o.settings.targetPlaceholder).appendTo(o.$target),h.enter=n("<span/>").addClass(w+"-enter").appendTo(o.$target),o.$target.appendTo(o.settings.container.target)},bind:function(){h.input.on("focus",function(){this.value==o.settings.targetPlaceholder&&(this.value="")}).on("blur",function(){this.value==""&&(this.value=o.settings.targetPlaceholder)}),h.input.on("change",function(){h.go(this.value)}),h.input.autoGrowInput({comfortZone:15,maxWidth:2e3})},set:function(e){h.input.val(e),h.input.trigger("update")},go:function(e){u.load(e)}},r={optional:{build:function(){r.$optional=o.$switcher.children('[data-viewport="optional"]'),r.optional.$container=n("<div/>").addClass(d+"-optional-container"),r.optional.$custom=n("<div class='"+d+"-optional-add'>"+"<div><label for='optional_width'>Width:</label><input type='number' id='optional_width' min='"+o.settings.min.width+"' value='' /></div>"+"<div><label for='optional_height'>Height:</label><input type='number' id='optional_height' min='"+o.settings.min.height+"' value='' /></div>"+"<div><button id='optional_add'>Add</button>"+"</div>").appendTo(r.optional.$container),r.optional.$width=r.optional.$custom.find("#optional_width"),r.optional.$height=r.optional.$custom.find("#optional_height"),r.optional.$add=r.optional.$custom.find("#optional_add"),r.optional.$saved=n("<ul/>").appendTo(r.optional.$container),r.optional.$container.appendTo(r.$optional)},activeMatch:function(e,t){var i=!1;return n(r.optional.$saved).children().each(function(){parseInt(n(this).data("width"))==e.width&&parseInt(n(this).data("height"))==e.height&&(n(this).trigger("click"),i=!0)}),i},addToSaved:function(e){i(e.width)&&i(e.height)&&r.optional.activeMatch(e)==0&&n("<li><div><span>Width: </span><span>"+e.width+"</span></div><div><span>Height: </span><span>"+e.height+"</span></div><div><button>Delete</button></div></li>").data("width",e.width).data("height",e.height).appendTo(r.optional.$saved).trigger("click")},active:function(e){n(e).attr("data-current","true"),n(e).siblings('[data-current="true"]').attr("data-current",null);var t=parseInt(n(e).data("width")),i=parseInt(n(e).data("height"));r.to("optional",{width:t,height:i})},deactive:function(){r.optional.$saved.find('[data-current="true"]').attr("data-current",null)},bind:function(){o.$optional.hover(function(e){o.$optional.attr("data-show","true"),i(o.current.width)&&r.optional.$width.val(o.current.width),i(o.current.height)&&r.optional.$height.val(o.current.height)},function(e){o.$optional.attr("data-show","false")}),r.optional.$width.on("change",function(){i(this.value)&&(this.value<o.settings.min.width&&(this.value=o.settings.min.width),o.$viewport.trigger("resize",{width:this.value}))}),r.optional.$height.on("change",function(){i(this.value)&&(this.value<o.settings.min.height&&(this.value=o.settings.min.height),o.$viewport.trigger("resize",{height:this.value}))}),r.optional.$add.on("click",function(){r.optional.addToSaved({width:r.optional.$width.val(),height:r.optional.$height.val()})}),r.optional.$saved.delegate("button","click",function(e){n(this).closest("li").remove()}),r.optional.$saved.delegate("li","click",function(e){r.optional.active(this)})}},build:function(){o.$switcher=n("<ul/>").addClass(d);var e=[];n.each(o.settings.viewports,function(t,n){e+="<li data-viewport='"+t+"' class='"+d+"-"+t+"'><a href='#'>"+n.description+"</a></li>"}),o.$switcher.append(e).appendTo(o.settings.container.switcher),o.$optional=o.$switcher.children('[data-viewport="optional"]'),r.optional.build()},to:function(e,t){o.current.viewport=e,e!="optional"&&(r.optional.deactive(),t=S(o.current.viewport)),o.current.width=t.width,o.current.height=t.height,e=="optional"?a.setQuery({viewport:e,width:t.width,height:t.height}):o.query.viewport!=e&&a.setQuery({viewport:e,width:null,height:null}),o.$switcher.children('[data-current="true"]').attr("data-current",null),o.$switcher.children('[data-viewport="'+e+'"]').attr("data-current","true"),o.$viewport.trigger("resize",o.current)},bind:function(){o.$switcher.delegate("a","click",function(e){var t=n(this).parent().data("viewport");t!=="optional"&&r.to(t),e.preventDefault()}),r.optional.bind()}},u={build:function(){o.$iframe=n("<iframe />").addClass(m).appendTo(o.$viewport)},bind:function(){o.$viewport.delegate(o.$iframe,"resize",function(e,t){var n={};typeof t.width!="undefined"&&(o.settings.scrollbarInWidth||!i(t.width)?n.width=t.width:n.width=t.width+p,o.current.width=t.width),typeof t.height!="undefined"&&(n.height=t.height,o.current.height=t.height),e.data.css(n)})},load:function(e){-1===e.search(/http(s){0,1}:\/\//)&&(e="http://"+e),o.$iframe.attr("src",e),o.query.target!=e&&a.setQuery({target:e})}},c={build:function(){o.$info=n('<div><div class="'+b+'-width"><span class="'+b+'-lable">Width: </span><span class="'+b+'-value"></span></div>'+'<div class="'+b+'-height"><span class="'+b+'-lable">Height: </span><span class="'+b+'-value"></span></div>'+"</div>").addClass(b).appendTo(o.$viewport),o.$infoWidth=o.$info.find("."+b+"-width ."+b+"-value"),o.$infoHeight=o.$info.find("."+b+"-height ."+b+"-value")},bind:function(){o.$viewport.delegate(o.$info,"resize",function(e,t){var n={};typeof t.width!="undefined"&&(n.marginLeft=s(t.width),o.$infoWidth.text(t.width)),typeof t.height!="undefined"&&(n.top=t.height,o.$infoHeight.text(t.height)),e.data.css(n)})}},l={build:function(){o.$axis=n("<div />").addClass(y),o.$axisX=n("<div />").addClass(y+"-x").prependTo(o.$axis),o.$axisY=n("<div />").addClass(y+"-y").prependTo(o.$axis),o.$axis.prependTo(o.$viewport)},bind:function(){o.$viewport.delegate(o.$axisX,"resize",function(e,t){if(typeof t.width!="undefined"){var n=t.width;if(!o.settings.scrollbarInWidth||!i(t.width))n=t.width+p;e.data.css({marginLeft:s(n)})}}),o.$viewport.delegate(o.$axisY,"resize",function(e,t){typeof t.height!="undefined"&&e.data.css({top:t.height})})}},f={build:function(){o.$resizable=n("<div />").addClass(g),o.$resizableX=n("<div />").addClass(g+"-x").prependTo(o.$resizable),o.$resizableY=n("<div />").addClass(g+"-y").prependTo(o.$resizable),o.$resizableXY=n("<div />").addClass(g+"-xy").prependTo(o.$resizable),o.$resizable.appendTo(o.$viewport)},bind:function(){o.$viewport.delegate(o.$resizable,"resize",function(e,t){var n={};if(typeof t.width!="undefined"){var r=t.width;if(!o.settings.scrollbarInWidth||!i(t.width))r=t.width+p;n.width=r,n.marginLeft=s("-"+r)}typeof t.height!="undefined"&&(n.height=t.height),e.data.css(n)}),o.$resizableX.drag("start",function(e,t){t.width=o.current.width,o.$viewport.attr("data-resizing","onx")}).drag(function(e,t){o.$viewport.trigger("resize",{width:Math.max(o.settings.min.width,t.width+parseInt(t.deltaX)*2)})}).drag("dragend",function(e,t){o.$viewport.attr("data-resizing",null)}),o.$resizableY.drag("start",function(e,t){t.height=o.current.height,o.$viewport.attr("data-resizing","ony")}).drag(function(e,t){o.$viewport.trigger("resize",{height:Math.max(o.settings.min.height,t.height+parseInt(t.deltaY))})}).drag("dragend",function(e,t){o.$viewport.attr("data-resizing",null)}),o.$resizableXY.drag("start",function(e,t){t.width=o.current.width,t.height=o.current.height,o.$viewport.attr("data-resizing","onxy")}).drag(function(e,t){o.$viewport.trigger("resize",{width:Math.max(o.settings.min.width,t.width+parseInt(t.deltaX)*2),height:Math.max(o.settings.min.height,t.height+parseInt(t.deltaY))})}).drag("dragend",function(e,t){o.$viewport.attr("data-resizing",null)})}},E()};o.settings={classNamePrefix:"resizer",container:{switcher:"header",target:"header",viewport:"article"},viewports:{auto:{width:"100%",height:"100%",description:"Auto"},optional:{description:"Optional"},mobile:{width:320,height:480,description:"Mobile"},tablet:{width:460,height:640,description:"Tablet"},notebook:{width:768,height:1024,description:"Notebook"},desktop:{width:1200,height:800,description:"Desktop"}},min:{width:240,height:320},step:5,targetPlaceholder:"Type your url here",scrollbarInWidth:!1,target:r},o.addViewport=function(e,t){o.viewports.slug=t}})(window,document,jQuery),function(e){e.fn.autoGrowInput=function(t){return t=e.extend({maxWidth:1e3,minWidth:0,comfortZone:70},t),this.filter("input:text").each(function(){var n=t.minWidth||e(this).width(),r="",i=e(this),s=e("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),u=function(){if(r===(r=i.val()))return;var e=r.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");s.html(e);var u=s.width(),a=u+t.comfortZone>=n?u+t.comfortZone:n,f=i.width(),l=a<f&&a>=n||a>n&&a<t.maxWidth;l&&i.width(a)};s.insertAfter(i),e(this).bind("keyup keydown blur update",u)}),this}}(jQuery);