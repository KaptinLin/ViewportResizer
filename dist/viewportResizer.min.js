/*! ViewportResizer - v0.1.0 - 2012-09-30
* https://github.com/KaptinLin/ViewportResizer
* Copyright (c) 2012 KaptinLin; Licensed GPL */
(function(e,t,n,r){"use strict";var i=n.ViewportResizer=function(t){function c(){s.build(),o.build(),i.$sizes.click(function(){h(n(this).data("size"))}),i.settings.target!==r?u.init(i.settings.target):u.init()}function h(e,t){s.to(e),o.to(e),t!==!1&&(n.extend(i.query,{viewport:e}),u.pushState(i.query))}function p(e){return{width:i.settings.sizes[e].width,height:i.settings.sizes[e].height}}function d(){var e=jQuery('<div style="width: 100%; height:200px;">test</div>'),t=jQuery('<div style="width:200px; height:150px; position: absolute; top: 0; left: 0; visibility: hidden; overflow:hidden;"></div>').append(e),n=e[0],r=t[0];jQuery("body").append(r);var i=n.offsetWidth;t.css("overflow","scroll");var s=r.clientWidth;return t.remove(),i-s}n.extend(i.settings,t);var s,o,u,a=d(),f=i.settings.classNamePrefix+"-switcher",l=i.settings.classNamePrefix+"-iframe";i.query={},e.onpopstate=function(e){e.state!==null&&e.state.viewport!==r&&h(e.state.viewport,!1)},u={init:function(e){n.extend(i.query,u.getQuery()),i.query.viewport!==r&&i.settings.sizes[i.query.viewport]!==r&&h(i.query.viewport,!1),i.query.target!==r?o.load(i.query.target):e!==r&&o.load(e)},pushState:function(t){if(e.history&&e.history.pushState&&e.history.replaceState){var r=[];n.each(t,function(e,t){r.push(e+"="+t)});var i="?"+r.join("&");e.history.pushState(t,"",i)}},getQuery:function(t){t===r&&(t=e.location.href);var i={},s=t.replace(/#[^\s]+/,"").split("?")[1];return s!==r&&(s=s.split("&"),n.each(s,function(e,t){var n=t.split("=");i[n[0]]=n[1]})),i}},s={build:function(){i.$switcher=n("<ul/>").addClass(f);var e=[];n.each(i.settings.sizes,function(t,n){e+="<li data-size='"+t+"' class='"+f+"-"+t+"'><a href='#'>"+n.description+"</a></li>"}),i.$switcher.append(e).appendTo(i.settings.container.switcher),i.$sizes=i.$switcher.find("li")},to:function(e){i.$sizes.filter('[data-current="true"]').attr("data-current",null),i.$sizes.filter('[data-size="'+e+'"]').attr("data-current","true")}},o={build:function(){i.$iframe=n("<iframe />").addClass(l).appendTo(i.settings.container.iframe)},load:function(e){-1===e.search(/http(s){0,1}:\/\//)&&(e="http://"+e),i.$iframe.attr("src",e)},to:function(e){var t=p(e),n=t.width+a;i.$iframe.attr("width",n).css({width:n})}},c()};i.settings={classNamePrefix:"resizer",container:{switcher:"header",iframe:"article"},sizes:{mobile:{width:320,height:480,description:"Mobile"},tablet:{width:460,height:640,description:"Tablet"},notebook:{width:768,height:1024,description:"Notebook"},desktop:{width:1200,height:800,description:"Desktop"}}},i.addSize=function(e,t){i.sizes.slug=t}})(window,document,jQuery);