/*! ViewportResizer - v0.3.0 - 2013-10-12
* https://github.com/KaptinLin/ViewportResizer
* Copyright (c) 2013 amazingSurge; Licensed GPL */
!function(a,b,c,d){"use strict";function e(a){return("string"==typeof a||"number"==typeof a)&&!isNaN(a-0)&&""!==a}function f(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function g(a){return e(a)?a/2:"string"==typeof a&&"%"===a.charAt(a.length-1)?a.substr(0,a.length-1)/2+"%":void 0}function h(){var a=jQuery('<div style="width: 100%; height:200px;">test</div>'),b=jQuery('<div style="width:200px; height:150px; position: absolute; top: 0; left: 0; visibility: hidden; overflow:hidden;"></div>').append(a),c=a[0],d=b[0];jQuery("body").append(d);var e=c.offsetWidth;b.css("overflow","scroll");var f=d.clientWidth;return b.remove(),e-f}var i=c.ViewportResizer=function(b){function d(){i.current={},i.initialization={},i.$viewport=c("<div />").addClass(t).appendTo(i.settings.container.viewport),i.$viewport.on("change",function(a,b){"undefined"!=typeof b&&("undefined"!=typeof b.viewport&&(i.current.viewport=b.viewport,"optional"!==b.viewport&&(b.dimensions=j(b.viewport)),i.current.width=b.dimensions.width,i.current.height=b.dimensions.height),"undefined"!=typeof b.target&&(i.current.target=b.target),i.$viewport.trigger("resize",{width:i.current.width,height:i.current.height}))}),i.$viewport.on("init",function(a,b){"undefined"!=typeof b&&("undefined"!=typeof b.viewport&&(i.initialization.viewport=b.viewport),"undefined"!=typeof b.target&&(i.initialization.target=b.target),f(b.dimensions)||(i.initialization.dimensions=b.dimensions))}),i.$viewport.trigger("init",{target:i.settings.target,viewport:i.settings.viewport,dimensions:i.settings.dimensions}),i.settings.components.inputer&&q.init(),i.settings.components.switcher&&k.init(),i.settings.components.iframe&&l.init(),i.settings.components.resizable&&n.init(),i.settings.components.axis&&o.init(),i.settings.components.info&&p.init(),i.settings.components.history&&m.init(),f(i.initialization)||i.$viewport.trigger("change",i.initialization)}function j(a){return"auto"===a?{width:"100%",height:"100%"}:{width:i.settings.viewports[a].width,height:i.settings.viewports[a].height}}c.extend(!0,i.settings,b);var k,l,m,n,o,p,q,r=h(),s=i.settings.namespace+"-switcher",t=i.settings.namespace+"-viewport",u=i.settings.namespace+"-iframe",v=i.settings.namespace+"-resizable",w=i.settings.namespace+"-axis",x=i.settings.namespace+"-info",y=i.settings.namespace+"-inputer";m={query:{},init:function(){c.extend(m.query,m.getQuery()),i.$viewport.on("init",function(a,b){if("undefined"!=typeof b){var c={};"undefined"!=typeof b.width&&(c.width=parseInt(b.width,10)),"undefined"!=typeof b.height&&(c.height=parseInt(b.height,10)),i.initialization.dimensions=c}}),f(m.query)||i.$viewport.trigger("init",m.query),a.onpopstate=function(b){a.onpopstateing=!0;var c={};null!==b.state&&("undefined"!=typeof b.state.viewport&&(c.viewport=b.state.viewport,"optional"===c.viewport&&(c.dimensions={width:b.state.width?parseInt(b.state.width,10):i.settings.min.width,height:b.state.height?parseInt(b.state.height,10):i.settings.min.height})),"undefined"!=typeof b.state.target&&(c.target=b.state.target),i.$viewport.trigger("change",c)),a.onpopstateing=!1,b.preventDefault()},i.$viewport.on("change",function(a,b){if("undefined"!=typeof b){var c={};"undefined"!=typeof b.viewport&&(c.viewport=b.viewport,"optional"===b.viewport&&"undefined"!==b.dimensions?(c.width=b.dimensions.width,c.height=b.dimensions.height):m.query.viewport!==b.viewport&&(c.width=null,c.height=null)),c.target="undefined"!=typeof b.target?b.target:i.current.target,m.setQuery(c)}})},pushState:function(b){if(a.onpopstateing!==!0&&a.history&&a.history.pushState&&a.history.replaceState){var d=[];c.each(b,function(a,b){null!=b&&d.push(a+"="+b)});var e="?"+d.join("&");a.history.pushState(b,"",e)}},getQuery:function(){var b=a.location.href,d={},e=b.replace(/#[^\s]+/,"").split("?")[1];return"undefined"!=typeof e&&(e=e.split("&"),c.each(e,function(a,b){var c=b.split("=");d[c[0]]=c[1]})),d},setQuery:function(a){a=c.extend(m.query,a),m.pushState(a)}},q={init:function(){q.build(),q.bind()},build:function(){i.$inputer=c("<div/>").addClass(y),q.input=c('<input type="text"/>').addClass(y+"-input").val(i.settings.inputerPlaceholder).appendTo(i.$inputer),q.enter=c("<span/>").addClass(y+"-enter").appendTo(i.$inputer),i.$inputer.appendTo(i.settings.container.inputer)},bind:function(){q.input.on("focus",function(){this.value===i.settings.inputerPlaceholder&&(this.value="")}).on("blur",function(){""===this.value&&(this.value=i.settings.inputerPlaceholder)}),q.input.on("change",function(){q.go(this.value)}),q.input.autoGrowInput({comfortZone:15,maxWidth:2e3}),i.$viewport.on("change",function(a,b){"undefined"!=typeof b&&"undefined"!=typeof b.target&&q.set(b.target)})},set:function(a){q.input.val(a)},go:function(a){i.$viewport.trigger("change",{target:a})}},k={init:function(){k.build(),k.bind(),"undefined"!=typeof i.settings.viewports.optional&&k.optional.init()},build:function(){i.$switcher=c("<ul/>").addClass(s);var a=[];c.each(i.settings.viewports,function(b,c){a+="<li data-viewport='"+b+"' class='"+s+"-"+b+"'><a href='#'>"+c.description+"</a></li>"}),i.$switcher.append(a).appendTo(i.settings.container.switcher)},to:function(a){i.$switcher.children('[data-current="true"]').attr("data-current",null),i.$switcher.children('[data-viewport="'+a+'"]').attr("data-current","true")},bind:function(){i.$switcher.delegate("a","click",function(a){var b=c(this).parent().data("viewport");"optional"===b||i.$viewport.trigger("change",{viewport:b}),a.preventDefault()}),i.$viewport.on("change",function(a,b){"undefined"!=typeof b&&"undefined"!=typeof b.viewport&&("optional"===b.viewport&&"undefined"!=typeof b.dimensions?(k.to("optional",b.dimensions),k.optional.activeMatch(b.dimensions)):k.to(b.viewport))})}},k.optional={init:function(){k.optional.build(),k.optional.bind()},build:function(){k.$optional=i.$switcher.children('[data-viewport="optional"]'),k.optional.$container=c("<div/>").addClass(s+"-optional-container"),k.optional.$custom=c("<div class='"+s+"-optional-add'>"+"<div><label for='optional_width'>Width:</label><input type='number' id='optional_width' min='"+i.settings.min.width+"' value='' /></div>"+"<div><label for='optional_height'>Height:</label><input type='number' id='optional_height' min='"+i.settings.min.height+"' value='' /></div>"+"<div><button id='optional_add'>Add</button>"+"</div>").appendTo(k.optional.$container),k.optional.$width=k.optional.$custom.find("#optional_width"),k.optional.$height=k.optional.$custom.find("#optional_height"),k.optional.$add=k.optional.$custom.find("#optional_add"),k.optional.$saved=c("<ul/>").appendTo(k.optional.$container),k.optional.$container.appendTo(k.$optional)},activeMatch:function(a){var b=!1;return c(k.optional.$saved).children().each(function(){parseInt(c(this).data("width"),10)===a.width&&parseInt(c(this).data("height"),10)===a.height&&(c(this).attr("data-current","true"),c(this).siblings('[data-current="true"]').attr("data-current",null),b=!0)}),b},addToSaved:function(a){e(a.width)&&e(a.height)&&k.optional.activeMatch(a)===!1&&c("<li><div><span>Width: </span><span>"+a.width+"</span></div><div><span>Height: </span><span>"+a.height+"</span></div><div><button>Delete</button></div></li>").data("width",a.width).data("height",a.height).appendTo(k.optional.$saved).trigger("click")},active:function(a){c(a).attr("data-current","true"),c(a).siblings('[data-current="true"]').attr("data-current",null),i.$viewport.trigger("change",{viewport:"optional",dimensions:{width:parseInt(c(a).data("width"),10),height:parseInt(c(a).data("height"),10)}})},deactive:function(){k.optional.$saved.find('[data-current="true"]').attr("data-current",null)},bind:function(){k.$optional.hover(function(){k.$optional.attr("data-show","true"),e(i.current.width)&&k.optional.$width.val(i.current.width),e(i.current.height)&&k.optional.$height.val(i.current.height)},function(){k.$optional.attr("data-show","false")}),k.optional.$width.on("change",function(){e(this.value)&&(this.value<i.settings.min.width&&(this.value=i.settings.min.width),i.$viewport.trigger("resize",{width:this.value}))}),k.optional.$height.on("change",function(){e(this.value)&&(this.value<i.settings.min.height&&(this.value=i.settings.min.height),i.$viewport.trigger("resize",{height:this.value}))}),k.optional.$add.on("click",function(){k.optional.addToSaved({width:k.optional.$width.val(),height:k.optional.$height.val()})}),k.optional.$saved.delegate("button","click",function(){c(this).closest("li").remove()}),k.optional.$saved.delegate("li","click",function(a){c(a.target).is("button")||k.optional.active(this)}),i.$viewport.on("change",function(a,b){"undefined"!=typeof b&&"undefined"!=typeof b.viewport&&"optional"!==b.viewport&&k.optional.deactive()})}},l={init:function(){l.build(),l.bind()},build:function(){i.$iframe=c('<iframe frameborder="no"/>').addClass(u).appendTo(i.$viewport)},bind:function(){i.$viewport.delegate(i.$iframe,"resize",function(a,b){if("undefined"!=typeof b){var c={};"undefined"!=typeof b.width&&(c.width=i.settings.scrollbarInWidth||!e(b.width)?b.width:b.width+r,i.current.width=b.width),"undefined"!=typeof b.height&&(c.height=b.height,i.current.height=b.height),a.data.css(c)}}),i.$viewport.on("change",function(a,b){"undefined"!=typeof b&&"undefined"!=typeof b.target&&l.load(b.target)})},load:function(a){-1===a.search(/http(s){0,1}:\/\//)&&(a="http://"+a),i.$iframe.attr("src",a)}},p={init:function(){p.build(),p.bind()},build:function(){i.$info=c('<div><div class="'+x+'-width"><span class="'+x+'-lable">Width: </span><span class="'+x+'-value"></span></div>'+'<div class="'+x+'-height"><span class="'+x+'-lable">Height: </span><span class="'+x+'-value"></span></div>'+"</div>").addClass(x).appendTo(i.$viewport),i.$infoWidth=i.$info.find("."+x+"-width ."+x+"-value"),i.$infoHeight=i.$info.find("."+x+"-height ."+x+"-value")},bind:function(){i.$viewport.delegate(i.$info,"resize",function(a,b){if("undefined"!=typeof b){var c={};"undefined"!=typeof b.width&&(c.marginLeft=g(b.width),i.$infoWidth.text(b.width)),"undefined"!=typeof b.height&&(c.top=b.height,i.$infoHeight.text(b.height)),a.data.css(c)}})}},o={init:function(){o.build(),o.bind()},build:function(){i.$axis=c("<div />").addClass(w),i.$axisX=c("<div />").addClass(w+"-x").prependTo(i.$axis),i.$axisY=c("<div />").addClass(w+"-y").prependTo(i.$axis),i.$axis.prependTo(i.$viewport)},bind:function(){i.$viewport.delegate(i.$axisX,"resize",function(a,b){if("undefined"!=typeof b&&"undefined"!=typeof b.width){var c=b.width;i.settings.scrollbarInWidth&&e(b.width)||(c=b.width+r),a.data.css({marginLeft:g(c)})}}),i.$viewport.delegate(i.$axisY,"resize",function(a,b){"undefined"!=typeof b&&"undefined"!=typeof b.height&&a.data.css({top:b.height})})}},n={init:function(){n.build(),n.bind()},build:function(){i.$resizable=c("<div />").addClass(v),i.$resizableX=c("<div />").addClass(v+"-x").prependTo(i.$resizable),i.$resizableY=c("<div />").addClass(v+"-y").prependTo(i.$resizable),i.$resizableXY=c("<div />").addClass(v+"-xy").prependTo(i.$resizable),i.$resizable.appendTo(i.$viewport)},bind:function(){i.$viewport.delegate(i.$resizable,"resize",function(a,b){if("undefined"!=typeof b){var c={};if("undefined"!=typeof b.width){var d=b.width;i.settings.scrollbarInWidth&&e(b.width)||(d=b.width+r),c.width=d,c.marginLeft=g("-"+d)}"undefined"!=typeof b.height&&(c.height=b.height),a.data.css(c)}}),i.$resizableX.drag("start",function(a,b){b.width=i.current.width,i.$viewport.attr("data-resizing","onx")}).drag(function(a,b){i.$viewport.trigger("resize",{width:Math.max(i.settings.min.width,b.width+2*parseInt(b.deltaX,10))})}).drag("dragend",function(){i.$viewport.attr("data-resizing",null)}),i.$resizableY.drag("start",function(a,b){b.height=i.current.height,i.$viewport.attr("data-resizing","ony")}).drag(function(a,b){i.$viewport.trigger("resize",{height:Math.max(i.settings.min.height,b.height+parseInt(b.deltaY,10))})}).drag("dragend",function(){i.$viewport.attr("data-resizing",null)}),i.$resizableXY.drag("start",function(a,b){b.width=i.current.width,b.height=i.current.height,i.$viewport.attr("data-resizing","onxy")}).drag(function(a,b){i.$viewport.trigger("resize",{width:Math.max(i.settings.min.width,b.width+2*parseInt(b.deltaX,10)),height:Math.max(i.settings.min.height,b.height+parseInt(b.deltaY,10))})}).drag("dragend",function(){i.$viewport.attr("data-resizing",null)})}},d()};i.settings={viewport:"auto",target:d,dimensions:{},components:{history:!0,inputer:!0,switcher:!0,iframe:!0,resizable:!0,axis:!0,info:!0},namespace:"resizer",container:{switcher:"header",inputer:"header",viewport:"article"},viewports:{auto:{width:"100%",height:"100%",description:"Auto"},optional:{description:"Optional"},mobile:{width:320,height:480,description:"Mobile"},tablet:{width:480,height:640,description:"Tablet"},notebook:{width:768,height:1024,description:"Notebook"},desktop:{width:1200,height:800,description:"Desktop"}},min:{width:240,height:320},step:5,inputerPlaceholder:"Type your url here",scrollbarInWidth:!0},i.addViewport=function(a,b){i.viewports.slug=b},i.go=function(a){i.$viewport.trigger("change",{target:a})},i.use=function(a){i.$viewport.trigger("change",{viewport:a})},i.change=function(a){i.$viewport.trigger("change",a)},i.resize=function(a){i.$viewport.trigger("resize",a)},i.resizeWidth=function(a){i.$viewport.trigger("resize",{width:a})},i.resizeHeight=function(a){i.$viewport.trigger("resize",{height:a})}}(window,document,jQuery),function(a,b){b.fn.autoGrowInput=function(a){return a=b.extend({maxWidth:1e3,minWidth:0,comfortZone:70},a),this.filter("input:text").each(function(){var c=a.minWidth||b(this).width(),d="",e=b(this),f=b("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:e.css("fontSize"),fontFamily:e.css("fontFamily"),fontWeight:e.css("fontWeight"),letterSpacing:e.css("letterSpacing"),whiteSpace:"nowrap"}),g=function(){if(d!==(d=e.val())){var b=d.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");f.html(b);var g=f.width(),h=g+a.comfortZone>=c?g+a.comfortZone:c,i=e.width(),j=i>h&&h>=c||h>c&&h<a.maxWidth;j&&e.width(h)}};f.insertAfter(e),b(this).bind("keyup keydown blur update",g)}),this}}(document,jQuery);