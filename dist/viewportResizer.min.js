/*! ViewportResizer - v0.3 - 2012-10-31
* https://github.com/KaptinLin/ViewportResizer
* Copyright (c) 2012 KaptinLin; Licensed CC BY-NC 3.0 */
(function(e,t,n,r){"use strict";function i(e){return(typeof e=="string"||typeof e=="number")&&!isNaN(e-0)&&e!==""}function s(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e){if(i(e))return e/2;if(typeof e=="string"&&e.charAt(e.length-1)==="%")return e.substr(0,e.length-1)/2+"%"}function u(){var e=jQuery('<div style="width: 100%; height:200px;">test</div>'),t=jQuery('<div style="width:200px; height:150px; position: absolute; top: 0; left: 0; visibility: hidden; overflow:hidden;"></div>').append(e),n=e[0],r=t[0];jQuery("body").append(r);var i=n.offsetWidth;t.css("overflow","scroll");var s=r.clientWidth;return t.remove(),i-s}var a=n.ViewportResizer=function(t){function x(){a.current={},a.initialization={},a.$viewport=n("<div />").addClass(g).appendTo(a.settings.container.viewport),a.$viewport.on("change",function(e,t){if(typeof t=="undefined")return;typeof t.viewport!="undefined"&&(a.current.viewport=t.viewport,t.viewport!=="optional"&&(t.dimensions=T(t.viewport)),a.current.width=t.dimensions.width,a.current.height=t.dimensions.height),typeof t.target!="undefined"&&(a.current.target=t.target),a.$viewport.trigger("resize",{width:a.current.width,height:a.current.height})}),a.$viewport.on("init",function(e,t){if(typeof t=="undefined")return;typeof t.viewport!="undefined"&&(a.initialization.viewport=t.viewport),typeof t.target!="undefined"&&(a.initialization.target=t.target),s(t.dimensions)||(a.initialization.dimensions=t.dimensions)}),a.$viewport.trigger("init",{target:a.settings.target,viewport:a.settings.viewport,dimensions:a.settings.dimensions}),a.settings.components.inputer&&d.init(),a.settings.components.switcher&&r.init(),a.settings.components.iframe&&f.init(),a.settings.components.resizable&&c.init(),a.settings.components.axis&&h.init(),a.settings.components.info&&p.init(),a.settings.components.history&&l.init(),s(a.initialization)||a.$viewport.trigger("change",a.initialization)}function T(e){return e==="auto"?{width:"100%",height:"100%"}:{width:a.settings.viewports[e].width,height:a.settings.viewports[e].height}}n.extend(!0,a.settings,t);var r,f,l,c,h,p,d,v=u(),m=a.settings.classNamePrefix+"-switcher",g=a.settings.classNamePrefix+"-viewport",y=a.settings.classNamePrefix+"-iframe",b=a.settings.classNamePrefix+"-resizable",w=a.settings.classNamePrefix+"-axis",E=a.settings.classNamePrefix+"-info",S=a.settings.classNamePrefix+"-inputer";l={query:{},init:function(){n.extend(l.query,l.getQuery()),a.$viewport.on("init",function(e,t){if(typeof t=="undefined")return;var n={};typeof t.width!="undefined"&&(n.width=parseInt(t.width,10)),typeof t.height!="undefined"&&(n.height=parseInt(t.height,10)),a.initialization.dimensions=n}),s(l.query)||a.$viewport.trigger("init",l.query),e.onpopstate=function(t){e.onpopstateing=!0;var n={};t.state!==null&&(typeof t.state.viewport!="undefined"&&(n.viewport=t.state.viewport,n.viewport==="optional"&&(n.dimensions={width:t.state.width?parseInt(t.state.width,10):a.settings.min.width,height:t.state.height?parseInt(t.state.height,10):a.settings.min.height})),typeof t.state.target!="undefined"&&(n.target=t.state.target),a.$viewport.trigger("change",n)),e.onpopstateing=!1,t.preventDefault()},a.$viewport.on("change",function(e,t){if(typeof t=="undefined")return;var n={};typeof t.viewport!="undefined"&&(n.viewport=t.viewport,t.viewport==="optional"&&t.dimensions!=="undefined"?(n.width=t.dimensions.width,n.height=t.dimensions.height):l.query.viewport!==t.viewport&&(n.width=null,n.height=null)),typeof t.target!="undefined"?n.target=t.target:n.target=a.current.target,l.setQuery(n)})},pushState:function(t){if(e.onpopstateing===!0)return;if(e.history&&e.history.pushState&&e.history.replaceState){var r=[];n.each(t,function(e,t){t!=null&&r.push(e+"="+t)});var i="?"+r.join("&");e.history.pushState(t,"",i)}},getQuery:function(){var t=e.location.href,r={},i=t.replace(/#[^\s]+/,"").split("?")[1];return typeof i!="undefined"&&(i=i.split("&"),n.each(i,function(e,t){var n=t.split("=");r[n[0]]=n[1]})),r},setQuery:function(e){e=n.extend(l.query,e),l.pushState(e)}},d={init:function(){d.build(),d.bind()},build:function(){a.$inputer=n("<div/>").addClass(S),d.input=n('<input type="text"/>').addClass(S+"-input").val(a.settings.inputerPlaceholder).appendTo(a.$inputer),d.enter=n("<span/>").addClass(S+"-enter").appendTo(a.$inputer),a.$inputer.appendTo(a.settings.container.inputer)},bind:function(){d.input.on("focus",function(){this.value===a.settings.inputerPlaceholder&&(this.value="")}).on("blur",function(){this.value===""&&(this.value=a.settings.inputerPlaceholder)}),d.input.on("change",function(){d.go(this.value)}),d.input.autoGrowInput({comfortZone:15,maxWidth:2e3}),a.$viewport.on("change",function(e,t){if(typeof t=="undefined")return;typeof t.target!="undefined"&&d.set(t.target)})},set:function(e){d.input.val(e)},go:function(e){a.$viewport.trigger("change",{target:e})}},r={init:function(){r.build(),r.bind(),typeof a.settings.viewports["optional"]!="undefined"&&r.optional.init()},build:function(){a.$switcher=n("<ul/>").addClass(m);var e=[];n.each(a.settings.viewports,function(t,n){e+="<li data-viewport='"+t+"' class='"+m+"-"+t+"'><a href='#'>"+n.description+"</a></li>"}),a.$switcher.append(e).appendTo(a.settings.container.switcher)},to:function(e,t){a.$switcher.children('[data-current="true"]').attr("data-current",null),a.$switcher.children('[data-viewport="'+e+'"]').attr("data-current","true")},bind:function(){a.$switcher.delegate("a","click",function(e){var t=n(this).parent().data("viewport");t!=="optional"&&a.$viewport.trigger("change",{viewport:t}),e.preventDefault()}),a.$viewport.on("change",function(e,t){if(typeof t=="undefined")return;typeof t.viewport!="undefined"&&(t.viewport==="optional"&&typeof t.dimensions!="undefined"?(r.to("optional",t.dimensions),r.optional.activeMatch(t.dimensions)):r.to(t.viewport))})}},r.optional={init:function(){r.optional.build(),r.optional.bind()},build:function(){r.$optional=a.$switcher.children('[data-viewport="optional"]'),r.optional.$container=n("<div/>").addClass(m+"-optional-container"),r.optional.$custom=n("<div class='"+m+"-optional-add'>"+"<div><label for='optional_width'>Width:</label><input type='number' id='optional_width' min='"+a.settings.min.width+"' value='' /></div>"+"<div><label for='optional_height'>Height:</label><input type='number' id='optional_height' min='"+a.settings.min.height+"' value='' /></div>"+"<div><button id='optional_add'>Add</button>"+"</div>").appendTo(r.optional.$container),r.optional.$width=r.optional.$custom.find("#optional_width"),r.optional.$height=r.optional.$custom.find("#optional_height"),r.optional.$add=r.optional.$custom.find("#optional_add"),r.optional.$saved=n("<ul/>").appendTo(r.optional.$container),r.optional.$container.appendTo(r.$optional)},activeMatch:function(e,t){var i=!1;return n(r.optional.$saved).children().each(function(){parseInt(n(this).data("width"),10)===e.width&&parseInt(n(this).data("height"),10)===e.height&&(n(this).attr("data-current","true"),n(this).siblings('[data-current="true"]').attr("data-current",null),i=!0)}),i},addToSaved:function(e){i(e.width)&&i(e.height)&&r.optional.activeMatch(e)===!1&&n("<li><div><span>Width: </span><span>"+e.width+"</span></div><div><span>Height: </span><span>"+e.height+"</span></div><div><button>Delete</button></div></li>").data("width",e.width).data("height",e.height).appendTo(r.optional.$saved).trigger("click")},active:function(e){n(e).attr("data-current","true"),n(e).siblings('[data-current="true"]').attr("data-current",null),a.$viewport.trigger("change",{viewport:"optional",dimensions:{width:parseInt(n(e).data("width"),10),height:parseInt(n(e).data("height"),10)}})},deactive:function(){r.optional.$saved.find('[data-current="true"]').attr("data-current",null)},bind:function(){r.$optional.hover(function(e){r.$optional.attr("data-show","true"),i(a.current.width)&&r.optional.$width.val(a.current.width),i(a.current.height)&&r.optional.$height.val(a.current.height)},function(e){r.$optional.attr("data-show","false")}),r.optional.$width.on("change",function(){i(this.value)&&(this.value<a.settings.min.width&&(this.value=a.settings.min.width),a.$viewport.trigger("resize",{width:this.value}))}),r.optional.$height.on("change",function(){i(this.value)&&(this.value<a.settings.min.height&&(this.value=a.settings.min.height),a.$viewport.trigger("resize",{height:this.value}))}),r.optional.$add.on("click",function(){r.optional.addToSaved({width:r.optional.$width.val(),height:r.optional.$height.val()})}),r.optional.$saved.delegate("button","click",function(e){n(this).closest("li").remove()}),r.optional.$saved.delegate("li","click",function(e){n(e.target).is("button")||r.optional.active(this)}),a.$viewport.on("change",function(e,t){if(typeof t=="undefined")return;typeof t.viewport!="undefined"&&t.viewport!=="optional"&&r.optional.deactive()})}},f={init:function(){f.build(),f.bind()},build:function(){a.$iframe=n('<iframe frameborder="no"/>').addClass(y).appendTo(a.$viewport)},bind:function(){a.$viewport.delegate(a.$iframe,"resize",function(e,t){if(typeof t=="undefined")return;var n={};typeof t.width!="undefined"&&(a.settings.scrollbarInWidth||!i(t.width)?n.width=t.width:n.width=t.width+v,a.current.width=t.width),typeof t.height!="undefined"&&(n.height=t.height,a.current.height=t.height),e.data.css(n)}),a.$viewport.on("change",function(e,t){if(typeof t=="undefined")return;typeof t.target!="undefined"&&f.load(t.target)})},load:function(e){-1===e.search(/http(s){0,1}:\/\//)&&(e="http://"+e),a.$iframe.attr("src",e)}},p={init:function(){p.build(),p.bind()},build:function(){a.$info=n('<div><div class="'+E+'-width"><span class="'+E+'-lable">Width: </span><span class="'+E+'-value"></span></div>'+'<div class="'+E+'-height"><span class="'+E+'-lable">Height: </span><span class="'+E+'-value"></span></div>'+"</div>").addClass(E).appendTo(a.$viewport),a.$infoWidth=a.$info.find("."+E+"-width ."+E+"-value"),a.$infoHeight=a.$info.find("."+E+"-height ."+E+"-value")},bind:function(){a.$viewport.delegate(a.$info,"resize",function(e,t){if(typeof t=="undefined")return;var n={};typeof t.width!="undefined"&&(n.marginLeft=o(t.width),a.$infoWidth.text(t.width)),typeof t.height!="undefined"&&(n.top=t.height,a.$infoHeight.text(t.height)),e.data.css(n)})}},h={init:function(){h.build(),h.bind()},build:function(){a.$axis=n("<div />").addClass(w),a.$axisX=n("<div />").addClass(w+"-x").prependTo(a.$axis),a.$axisY=n("<div />").addClass(w+"-y").prependTo(a.$axis),a.$axis.prependTo(a.$viewport)},bind:function(){a.$viewport.delegate(a.$axisX,"resize",function(e,t){if(typeof t=="undefined")return;if(typeof t.width!="undefined"){var n=t.width;if(!a.settings.scrollbarInWidth||!i(t.width))n=t.width+v;e.data.css({marginLeft:o(n)})}}),a.$viewport.delegate(a.$axisY,"resize",function(e,t){if(typeof t=="undefined")return;typeof t.height!="undefined"&&e.data.css({top:t.height})})}},c={init:function(){c.build(),c.bind()},build:function(){a.$resizable=n("<div />").addClass(b),a.$resizableX=n("<div />").addClass(b+"-x").prependTo(a.$resizable),a.$resizableY=n("<div />").addClass(b+"-y").prependTo(a.$resizable),a.$resizableXY=n("<div />").addClass(b+"-xy").prependTo(a.$resizable),a.$resizable.appendTo(a.$viewport)},bind:function(){a.$viewport.delegate(a.$resizable,"resize",function(e,t){if(typeof t=="undefined")return;var n={};if(typeof t.width!="undefined"){var r=t.width;if(!a.settings.scrollbarInWidth||!i(t.width))r=t.width+v;n.width=r,n.marginLeft=o("-"+r)}typeof t.height!="undefined"&&(n.height=t.height),e.data.css(n)}),a.$resizableX.drag("start",function(e,t){t.width=a.current.width,a.$viewport.attr("data-resizing","onx")}).drag(function(e,t){a.$viewport.trigger("resize",{width:Math.max(a.settings.min.width,t.width+parseInt(t.deltaX,10)*2)})}).drag("dragend",function(e,t){a.$viewport.attr("data-resizing",null)}),a.$resizableY.drag("start",function(e,t){t.height=a.current.height,a.$viewport.attr("data-resizing","ony")}).drag(function(e,t){a.$viewport.trigger("resize",{height:Math.max(a.settings.min.height,t.height+parseInt(t.deltaY,10))})}).drag("dragend",function(e,t){a.$viewport.attr("data-resizing",null)}),a.$resizableXY.drag("start",function(e,t){t.width=a.current.width,t.height=a.current.height,a.$viewport.attr("data-resizing","onxy")}).drag(function(e,t){a.$viewport.trigger("resize",{width:Math.max(a.settings.min.width,t.width+parseInt(t.deltaX,10)*2),height:Math.max(a.settings.min.height,t.height+parseInt(t.deltaY,10))})}).drag("dragend",function(e,t){a.$viewport.attr("data-resizing",null)})}},x()};a.settings={viewport:"auto",target:r,dimensions:{},components:{history:!0,inputer:!0,switcher:!0,iframe:!0,resizable:!0,axis:!0,info:!0},classNamePrefix:"resizer",container:{switcher:"header",inputer:"header",viewport:"article"},viewports:{auto:{width:"100%",height:"100%",description:"Auto"},optional:{description:"Optional"},mobile:{width:320,height:480,description:"Mobile"},tablet:{width:480,height:640,description:"Tablet"},notebook:{width:768,height:1024,description:"Notebook"},desktop:{width:1200,height:800,description:"Desktop"}},min:{width:240,height:320},step:5,inputerPlaceholder:"Type your url here",scrollbarInWidth:!0},a.addViewport=function(e,t){a.viewports.slug=t},a.go=function(e){a.$viewport.trigger("change",{target:e})},a.use=function(e){a.$viewport.trigger("change",{viewport:e})},a.change=function(e){a.$viewport.trigger("change",e)},a.resize=function(e){a.$viewport.trigger("resize",e)},a.resizeWidth=function(e){a.$viewport.trigger("resize",{width:e})},a.resizeHeight=function(e){a.$viewport.trigger("resize",{height:e})}})(window,document,jQuery),function(e,t,n){t.fn.autoGrowInput=function(e){return e=t.extend({maxWidth:1e3,minWidth:0,comfortZone:70},e),this.filter("input:text").each(function(){var n=e.minWidth||t(this).width(),r="",i=t(this),s=t("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),u=function(){if(r===(r=i.val()))return;var t=r.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");s.html(t);var u=s.width(),a=u+e.comfortZone>=n?u+e.comfortZone:n,f=i.width(),l=a<f&&a>=n||a>n&&a<e.maxWidth;l&&i.width(a)};s.insertAfter(i),t(this).bind("keyup keydown blur update",u)}),this}}(document,jQuery);